<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>拼一拼 99买手机了</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name='apple-touch-fullscreen' content='yes'>
		<meta name="full-screen" content="no">
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />
		<meta name="format-detection" content="telephone=no" />
		<meta name="format-detection" content="address=no" />

		<link rel="stylesheet" href="asset/css/reset.css" />
		<link rel="stylesheet" type="text/css" href="asset/plug/swiper/swiper-3.4.0.min.css" />
		<link rel="stylesheet" href="asset/css/style.css" />

		<script src="asset/js/mr-app.js"></script>
		<script src="asset/plug/swiper/swiper-3.4.0.min.js"></script>
		<script src="asset/js/js.js"></script>

	</head>

	<body>
		<div class="float" data-name="活动未开始">
			<div class="inner">
				<div class="txt">
					<p class="f-tac">活动还未开始，请稍后再试！</p>
				</div>
				<a href="#" class="btn full" onclick="closeLayer('[data-name=活动未开始]')">知道了</a>
			</div>
		</div>
		<div class="float" data-name="活动已结束">
			<div class="inner">
				<div class="txt">
					<p class="f-tal">活动已结束，敬请关注中国人寿保险其他活动</p>
				</div>
				<a href="search.html" class="btn full">中奖查询</a>
			</div>
		</div>
		<div class="float" data-name="不允许建团">
			<div class="inner">
				<div class="txt">
					<p class="f-tac">您的建团数量已满，暂时无建团资格！</p>
				</div>
				<a href="#" class="btn full" onclick="closeLayer('[data-name=不允许建团]')">知道了</a>
			</div>
		</div>
		<div class="float" data-name="不允许加团">
			<div class="inner">
				<div class="txt">
					<p class="f-tac">您加团的数量已满，暂时无法加入其它团！</p>
				</div>
				<a href="#" class="btn full" onclick="closeLayer('[data-name=不允许加团]')">知道了</a>
			</div>
		</div>
		<div class="float" data-name="不允许重复加团">
			<div class="inner">
				<div class="txt">
					<p class="f-tac">您已和该团内成员组过团，不能加入该团!</p>
				</div>
				<a href="#" class="btn full" onclick="closeLayer('[data-name=不允许重复加团]')">知道了</a>
			</div>
		</div>
		<div class="float" data-name="二维码弹层">
			<div class="inner qr-code">
				<img src="asset/img/ps1/qr-code.png" />
				<p>扫描下方二维码，加入由中国人寿保险官方微信提供的99元买手机活动</p>
			</div>
			<a href="#" class="close" onclick="closeLayer('[data-name=二维码弹层]')"></a>
		</div>
		<div class="float" data-name="分享">
			<div class="share">
				<img src="asset/img/ps1/share.png" />
				<p>呼朋唤友来参团，你懂的</p>
			</div>
			<a href="#" class="close" onclick="closeLayer('[data-name=分享]')"></a>
		</div>
		<div class="mask"></div>

		<!--banner开始-->
		<div class="banner">
			<img class="img" src="asset/img/ps1/banner.jpg" />
		</div>
		<!--倒计时-->
		<div class="time-item">
			<strong id="day_show">00</strong>天<strong id="hour_show">00</strong>时<strong id="minute_show">00</strong>分<strong id="second_show">00</strong>秒
		</div>
		<div class="box">
			<!--产品信息-->
			<div class="product">
				<a href="#" flex="main:justify box:first">
					<img src="asset/img/ps1/2.jpg" />
					<h3>【99元拼购华为Mate9】4G+64G全网通。参与活动助力中网公开赛，成团越多，中奖机会越大！</h3>
				</a>
			</div>
		</div>
		<div class="box mt25 mb25">
			<!--活动说明-->
			<div class="edit-body">
				<h3>奖品详情</h3>
				<ol>
					<li>本活动由“中国人寿保险”微信举办，欢迎粉丝参加。</li>
					<li>参加者每人最多可创建5个新团，每人只能加入5次他人创建的团。团内凑满三人即为满员团。相同的两人仅能出现在一个团中。创建新团和加入他人团的行为无法撤销。</li>
					<li>活动时间自2017年9月30日开始，组团成绩统计截止时间为2017年10月8日上午10点，截止后将从所有满员团中根据预先设置规则抽出5个中奖团，中奖团内每一位粉丝都可获得华为手机优惠购买券一张。</li>
					<li>以抽奖截止日当天，上证指数收盘后三位（包含小数点后两位）为抽奖基数，将所有参加组数除以发奖组数（5组），每组从小到大排列选取抽奖基数为获奖组团。<br />如：以2017年9月7日上证收盘指数后三位550、16160组团数为例，16160/5=3232，则获奖组团号码为：550，3782,7014,10246,13478.</li>
					<li>凭券可在中国人寿官方App “掌上国寿”生活频道i购商城内，以人民币99元购买华为Mate9手机一部（4G+64G全网通，颜色选择范围以购买时的可选项为准），所涉及的税费由中国人寿承担。</li>
					<li>中国人寿保险官方微信将在2017年10月10日前公布中奖名单，请参与活动的用户关注中奖信息公布，及时查询中奖信息。如超过中奖有效期未回复领取获奖权限，视为自动放弃。</li>
					<li>如发现作弊行为，中国人寿保险官方微信有权取消其获奖资格。</li>
					<li>中国人寿保险官方公众号享有活动的最终解释权。</li>
				</ol>
			</div>
		</div>
		<div class="count-code" data-name="统计代码">
			<script type="text/javascript">
				var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
				document.write(unescape("%3Cspan id='cnzz_stat_icon_1264381987'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s13.cnzz.com/z_stat.php%3Fid%3D1264381987%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
			</script>
		</div>
	</body>
	<script type="text/javascript">
		var count = 0;
		var status = 0; //0:活动未开始;1:活动进行中;2:活动已经结束;

		var bannerImgm, curTime, startTime, endTime, productImg, productName, listJoin, isGuanzhu, jianTeam, jiaTeam;

		$(function() {
			$.infoInit();
		})

		$.infoInit = function() {
			$.ajax({
				type: "get",
				url: "product.json",
				async: false,
				success: function(res) {
					bannerImg = res.banner_img;
					curTime = res.curTime;
					startTime = res.start_time;
					endTime = res.end_time;
					productImg = res.product_img;
					productName = res.product_name;
					listJoin = res.list_join;
					isGuanzhu = res.is_guanzhu;
					jianTeam = res.jian_tuan;
					jiaTeam = res.jia_team;

					//设置banner
					//$(".banner .img").attr("src", bannerImg);

					//设置产品
					//$(".product img").attr("src", productImg);
					$(".product h3").html(productName);

					//初始头像名字为空
					$(".list-join s").hide();

					//设置倒计时
					var seconds, cur;
					var timer = null;

					cur = Math.floor(new Date().getTime() / 1000);
					start = Math.floor(new Date(startTime).getTime() / 1000);
					end = Math.floor(new Date(endTime).getTime() / 1000);

					if(cur < start) {
						clearInterval(timer)
						status = 0;
						console.log("活动还未开始!");
						openLayer('[data-name=活动未开始]')

					}

					if(cur <= end && cur >= start) {
						status = 1;
						console.log("活动进行中!")

						seconds = end - cur;
						daojishi(seconds);

						//请求接口定时获取拼团信息msg开始
						var timerMsg = null;
						$.msg()
						timerMsg = setInterval(function() {
							$.msg();
						}, 20000);
					}

					if(cur > end) {
						clearInterval(timer)
						status = 2;
						console.log("活动已经结束!");
						$(".mask[data-name=活动已结束]").show();
					}

					console.log("status:" + status);

				}
			});
		}

		$.msg = function() {
			var msgItem = '';
			$.ajax({
				type: "get",
				url: "msg.json",
				async: false,
				success: function(res) {
					var myMsg = res.msg; //信息内容(img/name/type)
					for(var i = 0; i < myMsg.length; i++) {
						msgItem += '<li><span class="msg-item"><img src="' + myMsg[i].img + '"/>' + myMsg[i].name + '&nbsp;&nbsp;' + myMsg[i].type + '</span></li>';
					};
					msgItem = '<ul class="list-msg animated fadeInDown">' + msgItem + '</ul>';
					count++;
					if(count == 1) {
						$(".banner").append(msgItem);
					} else {
						$(".list-msg").removeClass('fadeInDown animated').addClass('fadeOutDown animated').one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function() {
							$(".list-msg").remove();
							$(".banner").append(msgItem)
						});
					}
				}
			});
		}
	</script>

</html>